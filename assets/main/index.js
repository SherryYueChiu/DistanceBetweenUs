System.register("chunks:///_virtual/createOwn.ts",["./rollupPluginModLoBabelHelpers.js","cc"],(function(t){"use strict";var e,n,i,o,r,a,l,s,c,u;return{setters:[function(t){e=t.applyDecoratedDescriptor,n=t.inheritsLoose,i=t.initializerDefineProperty,o=t.assertThisInitialized},function(t){r=t.cclegacy,a=t._decorator,l=t.EditBox,s=t.Label,c=t.Node,u=t.Component}],execute:function(){var g,p,h,d,m,y,w,f,b,v,_;r._RF.push({},"86a0fGX/pFCk7nSs4r0RCAN","createOwn",void 0);var A=a.ccclass,C=a.property;t("CreateOwn",(g=A("CreateOwn"),p=C(l),h=C(s),d=C(c),m=C(c),g((f=e((w=function(t){function e(){for(var e,n=arguments.length,r=new Array(n),a=0;a<n;a++)r[a]=arguments[a];return e=t.call.apply(t,[this].concat(r))||this,i(e,"input_enterAppellation",f,o(e)),i(e,"label_sharelink",b,o(e)),i(e,"node_warning",v,o(e)),i(e,"node_alert",_,o(e)),e.myLat=null,e.myLng=null,e}n(e,t);var r=e.prototype;return r.onLoad=function(){this.isGeolocationAvailable()&&this.updateCurrentPosition()},r.onSubmit=function(){if(this.isGeolocationAvailable()&&this.myLat&&this.myLng){var t=new URL(window.location.href),e=btoa(this.myLat+","+this.myLng),n=new URLSearchParams({zwbyu:e,cnhu:this.input_enterAppellation.string||"他"});localStorage.setItem("myAppellation",this.input_enterAppellation.string),this.updateGtagData(),t.search=n.toString(),this.label_sharelink.string=t.toString();var i=this;navigator.clipboard.writeText(t.toString()).then((function(){console.log("Async: Copying to clipboard was successful!"),i.showAlert("OK","分享連結已經複製起來了")}),(function(t){console.error("Async: Could not copy text: ",t)}))}},r.isGeolocationAvailable=function(){return"geolocation"in navigator},r.updateCurrentPosition=function(){var t=this;navigator.geolocation.getCurrentPosition((function(e){var n=e.coords.latitude,i=e.coords.longitude;n||i?(t.myLat=n,t.myLng=i):t.showWarning("A02","找不到GPS訊號")}),(function(){t.showWarning("A01","找不到GPS訊號\n可能是瀏覽器不給予權限")}))},r.showAlert=function(t,e){this.node_alert.active=!0,this.node_alert.getChildByName("title").getComponent(s).string=t,this.node_alert.getChildByName("msg").getComponent(s).string=e,window.gtag("event","alert",{title:t,msg:e})},r.showWarning=function(t,e){this.node_warning.active=!0,this.node_warning.getChildByName("errorCode").getComponent(s).string="ERR"+t,this.node_warning.getChildByName("msg").getComponent(s).string=e,window.gtag("event","error",{errorCode:t,msg:e})},r.updateGtagData=function(){window.gtag("set",{myPos:localStorage.getItem("myPos"),myAppellation:localStorage.getItem("myAppellation"),sharerPos:localStorage.getItem("sharerPos"),sharerAppellation:localStorage.getItem("sharerAppellation")})},e}(u)).prototype,"input_enterAppellation",[p],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),b=e(w.prototype,"label_sharelink",[h],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),v=e(w.prototype,"node_warning",[d],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),_=e(w.prototype,"node_alert",[m],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),y=w))||y));r._RF.pop()}}}));

System.register("chunks:///_virtual/machResult.ts",["./rollupPluginModLoBabelHelpers.js","cc"],(function(t){"use strict";var e,n,a,i,r,o,l,s,c,u;return{setters:[function(t){e=t.applyDecoratedDescriptor,n=t.inheritsLoose,a=t.initializerDefineProperty,i=t.assertThisInitialized},function(t){r=t.cclegacy,o=t._decorator,l=t.Label,s=t.Node,c=t.director,u=t.Component}],execute:function(){var h,g,p,d,m,f,w,b,y,v,L;r._RF.push({},"1ca45zePANIcLqQkQ96Wv5q","machResult",void 0);var M=o.ccclass,_=o.property;t("MachResult",(h=M("MachResult"),g=_(l),p=_(l),d=_(l),m=_(s),h((b=e((w=function(t){function e(){for(var e,n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return e=t.call.apply(t,[this].concat(r))||this,a(e,"label_title",b,i(e)),a(e,"label_distanceMsg",y,i(e)),a(e,"label_hint",v,i(e)),a(e,"node_warning",L,i(e)),e.myLat=null,e.myLng=null,e.theirLat=null,e.theirLng=null,e}n(e,t);var r=e.prototype;return r.onLoad=function(){this.isGeolocationAvailable()&&this.updateCurrentPosition()},r.showResult=function(){var t,e=new URL(window.location.href).searchParams;try{if(null==(t=atob(e.get("zwbyu"))).match(/[\d\.]+,[\d\.]+/))return void this.showWarning("B00","網址錯誤，請重新要一份分享連結")}catch(t){return void this.showWarning("B00","網址錯誤，請重新要一份分享連結")}localStorage.setItem("sharerPos",t),this.updateGtagData();var n=t.split(","),a=n[0],i=n[1];if(this.theirLat=parseFloat(null!=a?a:"0"),this.theirLng=parseFloat(null!=i?i:"0"),this.theirLat&&this.theirLng){var r=e.get("cnhu")||"他";localStorage.setItem("sharerAppellation",r),this.updateGtagData();var o=this.calcDistance();o=180,this.label_title.string="你跟"+r+"距離了",this.label_distanceMsg.string=this.getDistanceText(o)+"!",this.label_hint.string="好像有點距離，偶爾記得約一下吶"}else this.showWarning("B00","網址錯誤，請重新要一份分享連結")},r.onClickCreateOwn=function(){window.gtag("event","click",{event:"onClickCreateOwn"}),c.loadScene("createOwn")},r.isGeolocationAvailable=function(){return"geolocation"in navigator},r.updateCurrentPosition=function(){var t=this;navigator.geolocation.getCurrentPosition((function(e){var n=e.coords.latitude,a=e.coords.longitude;n||a?(t.myLat=n,t.myLng=a,t.showResult(),localStorage.setItem("myPos",n+","+a),t.updateGtagData()):t.showWarning("A02","找不到GPS訊號")}),(function(){t.showWarning("A01","找不到GPS訊號\n可能是瀏覽器不給予權限")}))},r.getDistanceText=function(t){return t>1?Math.round(t)+"km":Math.round(1e3*t%1e3)+"m"},r.calcDistance=function(){var t=function(t){return t*Math.PI/180},e=this.myLat,n=this.myLng,a=this.theirLat,i=this.theirLng,r=t(a-e),o=t(i-n);e=t(e),a=t(a);var l=Math.sin(r/2)*Math.sin(r/2)+Math.sin(o/2)*Math.sin(o/2)*Math.cos(e)*Math.cos(a);return 6371*(2*Math.atan2(Math.sqrt(l),Math.sqrt(1-l)))},r.showWarning=function(t,e){this.node_warning.active=!0,this.node_warning.getChildByName("errorCode").getComponent(l).string="ERR"+t,this.node_warning.getChildByName("msg").getComponent(l).string=e,window.gtag("event","error",{errorCode:t,msg:e})},r.updateGtagData=function(){window.gtag("set",{myPos:localStorage.getItem("myPos"),myAppellation:localStorage.getItem("myAppellation"),sharerPos:localStorage.getItem("sharerPos"),sharerAppellation:localStorage.getItem("sharerAppellation")})},e}(u)).prototype,"label_title",[g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),y=e(w.prototype,"label_distanceMsg",[p],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),v=e(w.prototype,"label_hint",[d],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),L=e(w.prototype,"node_warning",[m],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),f=w))||f));r._RF.pop()}}}));

System.register("chunks:///_virtual/main",["./createOwn.ts","./machResult.ts","./main.ts"],(function(){"use strict";return{setters:[null,null,null],execute:function(){}}}));

System.register("chunks:///_virtual/main.ts",["./rollupPluginModLoBabelHelpers.js","cc"],(function(e){"use strict";var n,o,t,r,a;return{setters:[function(e){n=e.inheritsLoose},function(e){o=e.cclegacy,t=e._decorator,r=e.director,a=e.Component}],execute:function(){var i;o._RF.push({},"28ed0AEynVIz5fRmDOiNeVN","main",void 0);var c=t.ccclass;t.property,e("Entry",c("Entry")(i=function(e){function o(){return e.apply(this,arguments)||this}n(o,e);var t=o.prototype;return t.onLoad=function(){localStorage.clear(),this.isGeolocationAvailable(),new URL(window.location.href).searchParams.has("zwbyu")?r.loadScene("matchResult"):r.loadScene("createOwn")},t.isGeolocationAvailable=function(){return"geolocation"in navigator},o}(a))||i);o._RF.pop()}}}));

(function(r) {
  r('virtual:///prerequisite-imports/main', 'chunks:///_virtual/main'); 
})(function(mid, cid) {
    System.register(mid, [cid], function (_export, _context) {
    return {
        setters: [function(_m) {
            var _exportObj = {};

            for (var _key in _m) {
              if (_key !== "default" && _key !== "__esModule") _exportObj[_key] = _m[_key];
            }
      
            _export(_exportObj);
        }],
        execute: function () { }
    };
    });
});